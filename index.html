<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Idle Heroes Battle Simulator</title>
</head>

<style>
  .section {
    column-count: 3;
  }
  
  .subsection2 {
    column-span: 2;
  }
  
  .subsection1 {
    column-span: 1;
  }
  
  .log {
    height: 200px;
    overflow: scroll;
  }
</style>

<script src="heroes.js"></script>
<script src="heroSubclasses.js"></script>
<script src="baseHeroStats.js"></script>
<script src="guildTech.js"></script>
<script src="equipment.js"></script>
<script src="stone.js"></script>
<script src="artifact.js"></script>

<script>
  var attHeroes = [new hero("None")];
  var defHeroes = [];
    
    
  function initialize() {
    var prefix;
    
    addOptions(baseHeroStats, "Name");
    addOptions(weapons, "Weapon");
    addOptions(accessories, "Accessory");
    addOptions(armors, "Armor");
    addOptions(shoes, "Shoe");
    addOptions(stones, "Stone");
    addOptions(artifacts, "Artifact");
    
    for(i=0; i<attHeroes.length; i++) {
      prefix = i < 6 ? "att" : "def";
      document.getElementById(prefix + "Hero" + i + "Name").value = "Foolish";
      document.getElementById(prefix + "Hero" + i + "Stone").value = "T1 Attack";
      document.getElementById(prefix + "Hero" + i + "Artifact").value = "The Kiss of Ghost";
      changeHero(i);
    }
  }
  
  
  function addOptions(dictItems, strPostfix) {
    var option;
    var prefix;
    
    for(var x in dictItems) {
      option = document.createElement("option");
      option.text = x;
      for(i=0; i<attHeroes.length; i++) {
        prefix = i < 6 ? "att" : "def";
        document.getElementById(prefix + "Hero" + i + strPostfix).add(option);
      }
    }
  }
  
  
  function changeHero(heroPos) {
    var prefix = heroPos < 6 ? "att" : "def";
    var pHeroName = attHeroes[heroPos]._heroName;
    var cHeroName = document.getElementById(prefix + "Hero" + heroPos + "Name").value;
    var cHeroSheet = document.getElementById(prefix + "Hero" + heroPos + "Sheet");
    var fHeroName = document.getElementById(prefix + "Hero" + heroPos + "FieldName");
    var fHeroHP = document.getElementById(prefix + "Hero" + heroPos + "FieldHP");
    var fHeroBuffDebuff = document.getElementById(prefix + "Hero" + heroPos + "FieldBuffDebuff");
    
    console.log("Change Hero " + heroPos + ": " + pHeroName + " to " + cHeroName);
    
    if (pHeroName != cHeroName) {
      if(cHeroName == "None") {
        attHeroes[heroPos] = new hero("None", heroPos);
        cHeroSheet.innerHTML = "";
        fHeroName.innerHTML = "";
        fHeroHP.innerHTML = "";
        fHeroBuffDebuff.innerHTML = "";
      } else {
        attHeroes[heroPos] = new baseHeroStats[cHeroName]["className"](cHeroName, heroPos);
        fHeroName.innerHTML = cHeroName;
        fHeroBuffDebuff.innerHTML = "";
        updateHero(heroPos);
      }
    } else if(cHeroName == pHeroName) {
      // do nothing
    } else {
      cHeroSheet.innerHTML = "Hero not found.";
      fHeroName.innerHTML = "";
      fHeroHP.innerHTML = "";
      fHeroBuffDebuff.innerHTML = "";
    }
  }
  
  
  function updateHero(heroPos) {
    var prefix = heroPos < 6 ? "att" : "def";
    var cHeroName = document.getElementById(prefix + "Hero" + heroPos + "Name").value;
    var cHeroSheet = document.getElementById(prefix + "Hero" + heroPos + "Sheet");
    var fHeroHP = document.getElementById(prefix + "Hero" + heroPos + "FieldHP");
    console.log("updateHero " + heroPos + ": " + cHeroName);
    
    if (cHeroName != "None") {
      attHeroes[heroPos]._weapon = document.getElementById(prefix + "Hero" + heroPos + "Weapon").value;
      attHeroes[heroPos]._accessory = document.getElementById(prefix + "Hero" + heroPos + "Accessory").value;
      attHeroes[heroPos]._armor = document.getElementById(prefix + "Hero" + heroPos + "Armor").value;
      attHeroes[heroPos]._shoe = document.getElementById(prefix + "Hero" + heroPos + "Shoe").value;
      attHeroes[heroPos]._stone = document.getElementById(prefix + "Hero" + heroPos + "Stone").value;
      attHeroes[heroPos]._artifact = document.getElementById(prefix + "Hero" + heroPos + "Artifact").value;
      
      attHeroes[heroPos].updateCurrentStats();
      cHeroSheet.innerHTML = attHeroes[heroPos].getHeroSheet();
      fHeroHP.innerHTML = attHeroes[heroPos]._currentStats["totalHP"];
    }
  }
  
  
  function updateAttackers() {
    for (var i = 0; i < attHeroes.length; i++) {
      updateHero(i);
    }
  }
  
  
  function updateDefenders() {
    for (var i = 6; i < defHeroes.length + 6; i++) {
      updateHero(i + 6);
    }
  }
</script>

<body onload="initialize();">
  <hr/>
  
  <span>Battle Field</span>
  <div class="section" id="battleField">
    <div id="attHero0Field">
      <span id="attHero0FieldName"></span>
      <span id="attHero0FieldHP"></span>
      <span id="attHero0FieldBuffDebuff"></span>
    </div>
    
    <div id="battleFieldSpacer"></div>
    
    <div id="defHero0Field">
      <span id="defHero0FieldName"></span>
      <span id="defHero0FieldHP"></span>
      <span id="defHero0FieldBuffDebuff"></span>
    </div>
  </div>
  
  <hr/>
  
  <div>
    Combat Log
    <div class="log" id="combatLog">Hello World</div>
  </div>
  
  <hr/>
  
  <div class="section" id="attHero0Setup">
    <div class="subsection2">
      <span>Attacker Slot 1 Hero:</span><br/>
      
      <label for="attHero0Name">Hero: </label>
      <select id="attHero0Name" onchange="changeHero(0);"></select><br/>
      
      <label for="attHero0Skin">Skin: </label>
      <select id="attHero0Skin" onchange="updateHero(0);"></select><br />
      
      <label for="attHero0Stone">Stone: </label>
      <select id="attHero0Stone" onchange="updateHero(0);"></select><br />
      
      <label for="attHero0Artifact">Artifact: </label>
      <select id="attHero0Artifact" onchange="updateHero(0);"></select><br />
      
      <label for="attHero0Weapon">Weapon: </label>
      <select id="attHero0Weapon" onchange="updateHero(0);"></select><br />
      
      <label for="attHero0Accessory">Accessory: </label>
      <select id="attHero0Accessory" onchange="updateHero(0);"></select><br />
      
      <label for="attHero0Armor">Armor: </label>
      <select id="attHero0Armor" onchange="updateHero(0);"></select><br />
      
      <label for="attHero0Shoe">Shoe: </label>
      <select id="attHero0Shoe" onchange="updateHero(0);"></select><br />
      
      <label for="attHero0Enable1">Enable 1: </label>
      <select id="attHero0Enable1" onchange="updateHero(0);">
        <option value="None">None</option>
      </select><br />
      
      <label for="attHero0Enable2">Enable 2: </label>
      <select id="attHero0Enable2" onchange="updateHero(0);">
        <option value="None">None</option>
      </select><br />
      
      <label for="attHero0Enable3">Enable 3: </label>
      <select id="attHero0Enable3" onchange="updateHero(0);">
        <option value="None">None</option>
      </select><br />
      
      <label for="attHero0Enable4">Enable 4: </label>
      <select id="attHero0Enable4" onchange="updateHero(0);">
        <option value="None">None</option>
      </select><br />
      
      <label for="attHero0Enable5">Enable 5: </label>
      <select id="attHero0Enable5" onchange="updateHero(0);">
        <option value="None">None</option>
      </select><br />
    </div>
    
    <p class="subsection1">
      Hero Sheet:
      <div class="log" id="attHero0Sheet"></div>
    </p>
  </div>
  
  <hr/>
  
  <div class="section">
    <span>Attacker Config:</span><br/>
    
    <label for="avatarFrame">Select an Avatar Frame:</label>
    <select id="avatarFrame">
    </select><br/>
    
    <div>
      <span>Warrior Tech</span><br/>
      
      <label for="attTechWarriorhpPercent">HP: </label>
      <input id="attTechWarriorhpPercent" onchange="updateAttackers();" value="60" /><br/>
      
      <label for="attTechWarriorattackPercent">Attack: </label>
      <input id="attTechWarriorattackPercent" onchange="updateAttackers();" value="50" /><br/>
      
      <label for="attTechWarriorcrit">Crit: </label>
      <input id="attTechWarriorcrit" onchange="updateAttackers();" value="40" /><br/>
      
      <label for="attTechWarriorblock">Block: </label>
      <input id="attTechWarriorblock" onchange="updateAttackers();" value="30" /><br/>
      
      <label for="attTechWarriorskillDamage">Skill Damage: </label>
      <input id="attTechWarriorskillDamage" onchange="updateAttackers();" value="20" /><br/>
      
      <label for="attTechWarriorspeed">Speed: </label>
      <input id="attTechWarriorspeed" onchange="updateAttackers();" value="20" /><br/>
      
      <label for="attTechWarriorconstitution">Constitution: </label>
      <input id="attTechWarriorconstitution" onchange="updateAttackers();" value="20" /><br/>
      
      <label for="attTechWarriormind">Mind: </label>
      <input id="attTechWarriormind" onchange="updateAttackers();" value="20" /><br/>
      
      <label for="attTechWarriorantiMage">Anti Mage: </label>
      <input id="attTechWarriorantiMage" onchange="updateAttackers();" value="20" /><br/>
      
      <label for="attTechWarriorantiRanger">Anti Ranger: </label>
      <input id="attTechWarriorantiRanger" onchange="updateAttackers();" value="20" /><br/>
      
      <label for="attTechWarriorantiAssassin">Anti Assassin: </label>
      <input id="attTechWarriorantiAssassin" onchange="updateAttackers();" value="20" /><br/>
      
      <label for="attTechWarriorantiPriest">Anti Priest: </label>
      <input id="attTechWarriorantiPriest" onchange="updateAttackers();" value="20" /><br/>
      
      <label for="attTechWarriorstunImmune">Stun Immune: </label>
      <input id="attTechWarriorstunImmune" onchange="updateAttackers();" value="10" /><br/>
      
      <label for="attTechWarriorfreezeImmune">Freeze Immune: </label>
      <input id="attTechWarriorfreezeImmune" onchange="updateAttackers();" value="10" /><br/>
      
      <label for="attTechWarriorpetrifyImmune">Petrify Immune: </label>
      <input id="attTechWarriorpetrifyImmune" onchange="updateAttackers();" value="10" /><br/>
      
      <label for="attTechWarriortwineImmune">Twine Immune: </label>
      <input id="attTechWarriortwineImmune" onchange="updateAttackers();" value="10" /><br/>
    </div>
  </div>
  
  <hr/>

</body>

</html>